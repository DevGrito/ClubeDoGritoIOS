Fluxo de MissÃ£o da Semana
0) Entrada

De: Aba â€œMissÃ£o da Semanaâ€ â†’ PÃ¡gina: Lista de MissÃµes

Mostrar: cards com tÃ­tulo, pontos, prazo, status (DisponÃ­vel / Pendente validaÃ§Ã£o / ConcluÃ­da / Expirada) e â€œParticiparâ€.

1) Detalhe da MissÃ£o

Ao tocar no card:

Banner com tÃ­tulo + pontos + prazo.

DescriÃ§Ã£o curta (o que fazer).

CritÃ©rio de elegibilidade (plano, nÃ­vel, quantidade mÃ­nima de â€œGritosâ€, etc.).

Tipo de EvidÃªncia exigida (vem da tabela):

comentario (texto)

print (upload de imagem)

link (URL)

checkin (geolocalizaÃ§Ã£o ou botÃ£o â€œfiz aquiâ€)

video (upload curto ou link)

quiz (perguntas/respostas)

BotÃ£o â€œParticiparâ€ (se elegÃ­vel) ou â€œVer como participarâ€ (se nÃ£o elegÃ­vel â†’ CTA de upgrade).

2) FormulÃ¡rio dinÃ¢mico (conforme tipo de evidÃªncia)

Regra: renderizar o formulÃ¡rio pelo campo evidence_type.

comentario

Campo textarea (min 20 chars, mÃ¡x 600).

Placeholder orientativo (ex.: â€œConte rapidamente como vocÃª cumpriu a missÃ£oâ€¦â€).

print

Upload 1â€“3 imagens (JPG/PNG), tamanho mÃ¡x 5MB cada.

Campo opcional â€œObservaÃ§Ã£oâ€ (atÃ© 140 chars).

PrÃ©-visualizaÃ§Ã£o + recorte 4:5/16:9.

link

Campo URL (validaÃ§Ã£o http/https).

ValidaÃ§Ã£o de domÃ­nio permitido (se houver).

Campo opcional â€œComentÃ¡rioâ€ (atÃ© 140 chars).

checkin

BotÃ£o â€œFazer check-inâ€ (solicita localizaÃ§Ã£o).

DistÃ¢ncia mÃ¡xima do ponto-alvo (ex.: â‰¤ 500m) ou janela de tempo.

Fallback manual com foto + avaliaÃ§Ã£o humana (se sem GPS).

video

Upload (atÃ© 60s) ou link (YouTube/Drive).

Thumb gerada automaticamente.

quiz

Lista de perguntas (mÃºltipla escolha).

Regra de acerto (ex.: â‰¥70% para concluir).

Em todos os tipos:

Checkbox â€œDeclaro que Ã© conteÃºdo originalâ€.

BotÃ£o Enviar evidÃªncia (desabilitado atÃ© passar na validaÃ§Ã£o local).

3) ConfirmaÃ§Ã£o & Status

Ao enviar: status = "pendente_validacao".

Toast: â€œRecebemos sua evidÃªncia. Validaremos em atÃ© X horas.â€

BotÃ£o â€œAcompanharâ€ leva para Meus Envio(s).

4) ValidaÃ§Ã£o (automÃ¡tica + humana)

AutomÃ¡tica (sincrona):

Tamanho/formatos, URL vÃ¡lida, geofence, quiz score, anti-spam (mesmo link/imagem repetida).

Humana (assÃ­ncrona / fila):

Moderador marca Aprovado (ganha pontos) / Reprovado (informar motivo e permitir Refazer 1x).

5) PontuaÃ§Ã£o e feedback

Aprovado â†’ creditar pontos, mostrar selo â€œConcluÃ­daâ€ no card, registrar em HistÃ³rico.

Reprovado â†’ exibir motivo e botÃ£o Refazer (se permitido pela missÃ£o).

Expirada â†’ bloquear envio e exibir â€œMissÃ£o encerradaâ€.

Regras de NegÃ³cio (resumo)

Cada missÃ£o possui:

plano_minimo, nivel_minimo, pontos_recompensa, prazo_inicio/fim, limite_envios (ex.: 1 por usuÃ¡rio), evidence_type, review_required (boolean), auto_approve (quiz/check-in).

Upgrade CTA quando plano do usuÃ¡rio < plano_minimo.

Anti-fraude:

Hash de arquivos/imagens para impedir reuso massivo.

Bloqueio de URLs repetidas em massa.

Delay mÃ­nimo entre envios da mesma missÃ£o.

Acessibilidade: mensagem de ajuda por tipo de evidÃªncia + exemplos.

Modelo de Dados (sugestÃ£o)
// missions
{
  "id": "uuid",
  "title": "Convide um Amigo",
  "description": "Indique um amigo...",
  "points_reward": 200,
  "plan_min": "eco|voz|grito",
  "level_min": 0,
  "evidence_type": "comentario|print|link|checkin|video|quiz",
  "rules": {
    "min_chars": 20,
    "max_chars": 600,
    "allowed_domains": ["instagram.com","linkedin.com"],
    "max_images": 3,
    "max_video_seconds": 60,
    "geofence": {"lat": -19.83, "lng": -44.08, "radius_m": 500},
    "quiz_min_score": 70
  },
  "start_at": "2025-09-09T00:00:00Z",
  "end_at": "2025-09-15T23:59:59Z",
  "limit_per_user": 1,
  "auto_approve": false,
  "review_required": true
}

// submissions
{
  "id": "uuid",
  "mission_id": "uuid",
  "user_id": "uuid",
  "evidence": {
    "text": "â€¦",
    "images": ["file1.jpg","file2.jpg"],
    "url": "https://â€¦",
    "video": "â€¦",
    "geo": {"lat": -19.83, "lng": -44.08, "acc_m": 20},
    "quiz": {"score": 80, "answers": [2,1,3]}
  },
  "status": "pendente_validacao|aprovado|reprovado|expirado",
  "moderation_reason": null,
  "created_at": "â€¦",
  "approved_at": null,
  "points_awarded": 0
}

Endpoints (REST)

GET /missoes/semana â†’ lista (com status do usuÃ¡rio e elegibilidade).

GET /missoes/{id} â†’ detalhe + regras.

POST /missoes/{id}/enviar â†’ payload varia conforme evidence_type.

GET /me/missoes â†’ envios do usuÃ¡rio.

POST /moderacao/submissions/{id}/aprovar

POST /moderacao/submissions/{id}/reprovar

POST /missoes/{id}/refazer (se permitido)

RenderizaÃ§Ã£o dinÃ¢mica (pseudocÃ³digo)
function EvidenceForm({ mission }) {
  switch (mission.evidence_type) {
    case 'comentario':
      return <Textarea minLength={20} maxLength={600} required />;
    case 'print':
      return <ImageUploader maxFiles={3} accept={['image/png','image/jpeg']} />;
    case 'link':
      return <UrlInput validate={isValidUrl} allowedDomains={mission.rules?.allowed_domains} />;
    case 'checkin':
      return <CheckInButton geofence={mission.rules?.geofence} />;
    case 'video':
      return <VideoUploader maxSeconds={mission.rules?.max_video_seconds || 60} />;
    case 'quiz':
      return <Quiz questions={mission.quiz_questions} minScore={mission.rules?.quiz_min_score || 70} />;
  }
}

Textos prontos (UI)

MissÃ£o disponÃ­vel: â€œComplete a tarefa, envie a evidÃªncia e ganhe {pontos} Gritos.â€

Pendente: â€œRecebido! Validaremos sua evidÃªncia em atÃ© 24h.â€

Aprovada: â€œParabÃ©ns! ğŸ‰ VocÃª ganhou {pontos} Gritos.â€

Reprovada: â€œSua evidÃªncia nÃ£o atendeu Ã s regras: {motivo}. Toque em Refazer.â€

Expirada: â€œMissÃ£o encerrada. Fique de olho na prÃ³xima semana!â€